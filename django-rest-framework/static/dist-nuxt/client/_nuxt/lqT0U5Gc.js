import{_ as U}from"./CNH9lMdp.js";import{x as S,r as h,y as z,c as n,a,u as t,f as V,p as D,z as $,q as E,s as F,o as s,v as R}from"./Cj5KKtQi.js";import{u as T,a as f}from"./CQUXvy6G.js";const x={key:0},A={key:1},I={class:"mt-2"},N={key:0},Z={key:0},H={key:1},P=["disabled"],q=["disabled"],G={key:0,class:"spinner-border",role:"status"},J={key:1},j={__name:"[id]",async setup(K){let d,y;const c=R(),p=T(),g=S(),o=h(!1),i=h(!1),m=g.params.id,{data:r,status:_,refresh:v}=([d,y]=z(()=>f(`${c.public.serverUrl}/snippets/${m}/`,"$gZ7UzGyZdb")),d=await d,y(),d);async function C(){try{i.value=!0;const{data:l,status:e}=await f(`${c.public.serverUrl}/snippets/${m}/`,{method:"patch",headers:{Authorization:`Bearer ${p.accessToken}`},body:JSON.stringify(r.value)},"$P2f7BZgCUK");e.value=="success"?(v(),o.value=!1):alert("Failed to edit snippet, try again!")}catch(l){console.warn(l),alert("Error")}finally{i.value=!1}}function w(){v(),o.value=!1}async function B(){if(confirm("Do you want to delele this snippet?")){const{data:e,status:b}=await f(`${c.public.serverUrl}/snippets/${m}/`,{method:"delete",headers:{Authorization:`Bearer ${p.accessToken}`}},"$HzHR0TIfPk");b.value=="success"?(alert("Snippet deleted!"),F("/")):alert("Failed to delete snippet, try again!")}}return(l,e)=>{var k;const b=U;return s(),n("form",{class:"h-100 w-100 m-3",onSubmit:E(C,["prevent"])},[a("h1",null,[t(o)?(s(),n("span",x,"Edit")):(s(),n("span",A,"Detail"))]),t(_)=="success"?(s(),V(b,{key:0,modelValue:t(r),"onUpdate:modelValue":e[0]||(e[0]=u=>D(r)?r.value=u:null),"is-readonly":!t(o)||t(i)},null,8,["modelValue","is-readonly"])):$("",!0),a("div",I,[a("button",{class:"btn btn-secondary m-1",type:"button",onClick:e[1]||(e[1]=u=>l.$router.back())},"Back"),t(_)=="success"&&((k=t(p).userInfo)==null?void 0:k.username)==t(r).owner?(s(),n("span",N,[t(o)?(s(),n("span",H,[a("button",{class:"btn btn-primary m-1",type:"reset",onClick:e[4]||(e[4]=u=>w()),disabled:t(i)}," Cancel edit ",8,P),a("button",{class:"btn btn-success m-1",type:"submit",disabled:t(i)},[t(i)?(s(),n("span",G,e[5]||(e[5]=[a("span",{class:"visually-hidden"},"Loading...",-1)]))):(s(),n("span",J,"Submit"))],8,q)])):(s(),n("span",Z,[a("button",{class:"btn btn-primary m-1",type:"button",onClick:e[2]||(e[2]=u=>o.value=!0)},"Edit"),a("button",{class:"btn btn-danger m-1",type:"button",onClick:e[3]||(e[3]=u=>B())},"Delete")]))])):$("",!0)])],32)}}};export{j as default};
